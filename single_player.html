<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=800, initial-scale=1.0">
<title>AERONOM</title>
<style>
body {
    margin: 0;
    padding: 0;
    background: #1a1a2e;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    font-family: 'Courier New', monospace;
    color: #00ff00;
}
#gameContainer {
    position: relative;
    background: linear-gradient(to bottom, #16213e 0%, #0f3460 50%, #1a1a2e 100%);
    border: 3px solid #00ff00;
    box-shadow: 0 0 20px #00ff00;
}
#gameCanvas {
    display: block;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
}
#ui {
    position: absolute;
    top: 10px;
    left: 0;
    width: 100%;
    text-align: center;
    color: #00ff00;
    font-size: 18px;
    text-shadow: 2px 2px 0px #000000;
    z-index: 2;
    pointer-events: none;
    user-select: none;
}
#instructions {
    position: absolute;
    bottom: 10px;
    left: 10px;
    color: #00ff00;
    font-size: 12px;
    text-shadow: 1px 1px 0px #000000;
    z-index: 2;
    pointer-events: none;
    user-select: none;
}
.splash {
    position: absolute;
    top: 0;
    left: 0;
    width: 800px;
    height: 600px;
    background: rgba(0,0,0,0.85);
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: default;
    transition: opacity 0.4s;
    pointer-events: auto; /* Ensure splash itself can be interacted with */
}
.splash img {
    max-width: 90%;
    max-height: 80%;
    display: block;
    margin-bottom: 20px;
}
.fade {
    pointer-events: none;
    position: absolute;
    left: 0; top: 0;
    width: 800px; height: 600px;
    z-index: 9; /* Lower than splash, higher than game buttons */
    background: #000;
    opacity: 0;
    transition: opacity 1s;
}
#musicNotice {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #00ff00;
    background: rgba(0,0,0,0.8);
    border: 2px solid #00ff00;
    padding: 24px;
    font-size: 1.3em;
    z-index: 20; /* Highest z-index for this temporary notice */
    text-shadow: 2px 2px 0 #000;
    display: none;
    pointer-events: auto; /* Allow clicks on the notice */
}

/* --- Button Styles --- */
#gameButtons {
    position: absolute;
    bottom: 10px;
    right: 10px;
    z-index: 5; /* Ensure these are above game elements */
    display: flex;
    gap: 10px;
}
.game-button {
    background: #0f3460;
    color: #00ff00;
    border: 2px solid #00ff00;
    padding: 8px 16px;
    font-family: 'Courier New', monospace;
    font-size: 16px;
    cursor: pointer;
    box-shadow: 0 0 8px #00ff00;
    transition: background-color 0.2s, box-shadow 0.2s;
    pointer-events: auto; /* Ensure buttons are clickable */
}
.game-button:hover {
    background-color: #1a1a2e;
    box-shadow: 0 0 12px #00ff00;
}
.game-button:active {
    background-color: #0a1f38;
    box-shadow: 0 0 4px #00ff00;
}
/* Style for splash screen button */
#splash-start-button {
    margin-top: 20px;
    padding: 12px 24px;
    font-size: 20px;
    background: #00ff00;
    color: #0f3460;
    border: 2px solid #0f3460;
    box-shadow: 0 0 15px #00ff00;
}
#splash-start-button:hover {
    background-color: #00ee00;
    box-shadow: 0 0 20px #00ff00;
}
#splash-start-button:active {
    background-color: #00cc00;
    box-shadow: 0 0 8px #00ff00;
}

/* --- Control Buttons --- */
#controlButtons {
    position: absolute;
    bottom: 10px;
    left: 10px;
    z-index: 5; /* Ensure these are above game elements */
    display: grid;
    grid-template-areas:
        ". up ."
        "left . right"
        ". down .";
    grid-template-columns: repeat(3, 40px);
    grid-template-rows: repeat(3, 40px);
    gap: 5px;
    pointer-events: auto; /* Ensure buttons are clickable */
}

.control-button {
    background: #0f3460;
    color: #00ff00;
    border: 2px solid #00ff00;
    font-family: 'Courier New', monospace;
    font-size: 20px;
    cursor: pointer;
    box-shadow: 0 0 8px #00ff00;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
}
.control-button:hover {
    background-color: #1a1a2e;
    box-shadow: 0 0 12px #00ff00;
}
.control-button:active {
    background-color: #0a1f38;
    box-shadow: 0 0 4px #00ff00;
}

#upButton    { grid-area: up; }
#downButton  { grid-area: down; }
#leftButton  { grid-area: left; }
#rightButton { grid-area: right; }

</style>
</head>
<body>
<div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="ui">
        <span id="scorebox">SCORE: <span id="score">0</span></span>
        <span style="margin-left:32px;">LIVES: <span id="lives">3</span></span>
        <span style="margin-left:32px;">LEVEL: <span id="level">1</span></span>
        <span style="margin-left:32px;">STATUS: <span id="status">MONITORING</span></span>
    </div>
    <div id="instructions">
        Avoid Flares | Collect Emission Data<br>
    </div>
    <div id="splash" class="splash" style="display:none;">
        <img id="splash-img" src="" alt="Splash">
        <button id="splash-start-button" class="game-button">START MISSION</button>
    </div>
    <div id="fade" class="fade"></div>
    <div id="musicNotice">Click anywhere to enable background music!</div>

    <div id="gameButtons">
        <button id="pauseResumeButton" class="game-button">PAUSE</button>
        <button id="resetButton" class="game-button">RESET</button>
    </div>

    <div id="controlButtons" style="display:none;">
        <button id="upButton" class="control-button">▲</button>
        <button id="leftButton" class="control-button">◀</button>
        <button id="rightButton" class="control-button">▶</button>
        <button id="downButton" class="control-button">▼</button>
    </div>

</div>
<audio id="bg-music" src="" preload="auto"></audio>
<script>
// --- Asset paths ---
const ASSETS = {
    splash: {
        start: 'splash_start1.png',
        gameover: 'splash_gameover.png',
        victory: 'splash_victory.png'
    },
    bg: [
        'refinery_background.png',
        'level2_background.png',
        'level3_background.png'
    ]
};

// --- Music files (edit this list to match your mp3 files) ---
const MUSIC_FILES = [
    "song1.mp3",
    "song2.mp3",
    "song3.mp3",
    "song4.mp3",
    "song5.mp3",
    "song6.mp3",
    "song7.mp3"
    // Add more...
];

const flareIgniteSound = new Audio('flare_ignite.mp3');
const droneHitSound = new Audio('drone_hit.mp3');
flareIgniteSound.volume = 0.1;
droneHitSound.volume = 0.2;


// --- UI Elements ---
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
ctx.imageSmoothingEnabled = false;
const scoreElement = document.getElementById('score');
const livesElement = document.getElementById('lives');
const levelElement = document.getElementById('level');
const statusElement = document.getElementById('status');
const splashDiv = document.getElementById('splash');
const splashImg = document.getElementById('splash-img');
const fadeDiv = document.getElementById
